import json


def main():

    for i in range(8):
        data = {}
        with open(f'data_vol{i+1}.json', 'r') as f:
            prev_data = json.load(f)
            for key, value in prev_data.items():
                new_value = value[0]
                new_count = value[1]
                rev = prev_data.get(key[::-1])
                if rev:
                    rev_val = rev[0]
                    rev_count = rev[1]
                    new_value = (rev_val*rev_count + new_count*new_value) / (rev_count + new_count)
                    new_count += rev_count
                data[key[::-1]] = data[key] = (new_value, new_count)

        with open(f'data_vol{i+1}.json', 'w+') as f:
            json.dump(data, f)


if __name__ == "__main__":
    main()